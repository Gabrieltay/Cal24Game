function initLocalStorage(){null==window.localStorage.getItem("highest")&&window.localStorage.setItem("highest",0)}function node(e,n,t,r){this.leftChild=e,this.rightChild=n,this.weight=t,this.opera=r}function BuildUnbalLeftLong(e,n,t,r,o,u,l,i){var s=new node(null,null,n,-1),a=new node(null,null,t,-1),d=new node(s,a,-1e4,u),c=new node(null,null,r,-1),p=new node(d,c,-1e4,l),w=new node(null,null,o,-1);return e=new node(p,w,-1e4,i)}function BuildUnbalRightLong(e,n,t,r,o,u,l,i){var s=new node(null,null,n,-1),a=new node(null,null,t,-1),d=new node(s,a,-1e4,u),c=new node(null,null,r,-1),p=new node(c,d,-1e4,l),w=new node(null,null,o,-1);return e=new node(w,p,-1e4,i)}function BuildBal(e,n,t,r,o,u,l,i){var s=new node(null,null,n,-1),a=new node(null,null,t,-1),d=new node(s,a,-1e4,u),c=new node(null,null,r,-1),p=new node(null,null,o,-1),w=new node(c,p,-1e4,l);return e=new node(d,w,-1e4,i)}function BuildMidLeft(e,n,t,r,o,u,l,i){var s=new node(null,null,n,-1),a=new node(null,null,t,-1),d=new node(s,a,-1e4,u),c=new node(null,null,r,-1),p=new node(c,d,-1e4,l),w=new node(null,null,o,-1);return e=new node(p,w,-1e4,i)}function BuildMidRight(e,n,t,r,o,u,l,i){var s=new node(null,null,n,-1),a=new node(null,null,t,-1),d=new node(s,a,-1e4,u),c=new node(null,null,r,-1),p=new node(d,c,-1e4,l),w=new node(null,null,o,-1);return e=new node(w,p,-1e4,i)}function operate(e,n,t){switch(t){case 0:return result=e+n;case 1:return result=e-n;case 2:return result=e*n;case 3:return result=e/n;case 4:return result=Math.pow(e,n);default:return result=-1e4}}function operation_table(e){switch(e){case 0:return"+";case 1:return"-";case 2:return"*";case 3:return"/";case 4:return"^";default:return"_"}}function regular_prepare(e){switch(e){case 0:return"\\+";case 1:return"\\-";case 2:return"\\*";case 3:return"\\/";case 4:return"\\^";default:return"_"}}function generate_result(e){return null!=e.leftChild&&null!=e.rightChild?"("+generate_result(e.leftChild)+operation_table(e.opera)+generate_result(e.rightChild)+")":e.weight}function generate_RegExp(e){return null!=e.leftChild&&null!=e.rightChild?"\\("+generate_RegExp(e.leftChild)+regular_prepare(e.opera)+generate_RegExp(e.rightChild)+"\\)":e.weight}function weighten(e){null!=e.leftChild&&-1e4==e.leftChild.weight&&weighten(e.leftChild),null!=e.rightChild&&-1e4==e.rightChild.weight&&weighten(e.rightChild),e.weight=operate(e.leftChild.weight,e.rightChild.weight,e.opera)}function myRound(e){return Math.abs(e-Math.round(e))<1e-4?Math.round(e):void 0}function tree_construct(){var e,n,t,r,o,u,l,i=4;for(ifpower&&(i=5),e=0;4>e;e++)for(n=0;4>n;n++)if(e!=n)for(t=0;4>t;t++)if(e!=t&&n!=t)for(r=0;4>r;r++)if(e!=r&&n!=r&&t!=r)for(o=0;i>o;o++)for(u=0;i>u;u++)for(l=0;i>l;l++){var s=new node(null,null,-1e4,-1);s=BuildUnbalLeftLong(s,Number(inputs[e]),Number(inputs[n]),Number(inputs[t]),Number(inputs[r]),o,u,l),weighten(s),myRound(s.weight)==wanted&&add_result(generate_result(s),generate_RegExp(s)),s=BuildUnbalRightLong(s,Number(inputs[e]),Number(inputs[n]),Number(inputs[t]),Number(inputs[r]),o,u,l),weighten(s),myRound(s.weight)==wanted&&add_result(generate_result(s),generate_RegExp(s)),s=BuildBal(s,Number(inputs[e]),Number(inputs[n]),Number(inputs[t]),Number(inputs[r]),o,u,l),weighten(s),myRound(s.weight)==wanted&&add_result(generate_result(s),generate_RegExp(s)),s=BuildMidLeft(s,Number(inputs[e]),Number(inputs[n]),Number(inputs[t]),Number(inputs[r]),o,u,l),weighten(s),myRound(s.weight)==wanted&&add_result(generate_result(s),generate_RegExp(s)),s=BuildMidRight(s,Number(inputs[e]),Number(inputs[n]),Number(inputs[t]),Number(inputs[r]),o,u,l),weighten(s),myRound(s.weight)==wanted&&add_result(generate_result(s),generate_RegExp(s))}}function print_output(){""==resstr&&process()}function add_result(e,n){var t=new RegExp(n+" = "+wanted+"\n");1!=t.test(resstr)&&(resstr=resstr+e+" = "+wanted+"\n",numofsol++)}function process(){generate(),reset(),resstr="",numofsol=0,tree_construct(),print_output()}function pass(){return 0==passes?(alert("No more chance!"),void 0):(passes--,$("#chance"+passes).removeClass("chance"),process(),void 0)}function generate(){inputs[0]=Math.floor(10*Math.random()+1),inputs[1]=Math.floor(10*Math.random()+1),inputs[2]=Math.floor(10*Math.random()+1),inputs[3]=Math.floor(10*Math.random()+1),$("#in1").text(inputs[0]),$("#in2").text(inputs[1]),$("#in3").text(inputs[2]),$("#in4").text(inputs[3])}function timerEvent(){countdown--;var e=Math.floor((maxtime-countdown)/maxtime*100);$("#hourglass").animo("rotate",{degrees:180*(maxtime-countdown)}),$("#label-hour").text(toMinSec(countdown)),$(".progress-bar").css("width",e+"%").attr("aria-valuenow",e),0==countdown&&(complete(),clearInterval(myTimer))}function start(){score=0,passes=3,$("[id^=chance]").addClass("chance"),$(".btn-op").removeClass("selected"),clearInterval(myTimer),$("#score").text("Score: "+score),countdown=maxtime,$("#label-hour").text(toMinSec(countdown)),myTimer=setInterval(function(){timerEvent()},1e3),process()}function reset(){seq="first",firstNum=0,lastKey="",oper="",operNum=0,$(".btn-op").removeClass("selected");for(var e=1;4>=e;e++)$("#in"+e).prop("disabled",!1),$("#in"+e).removeClass("selected"),$("#in"+e).text(inputs[e-1])}function numKey(e){if(lastKey!=e){$("#in"+lastKey).removeClass("selected"),$("#in"+e).addClass("selected");var n=0;if("first"==seq||""==oper)lastKey=e,oper="";else if("second"==seq){if("+"==oper)n=firstNum+Number($("#in"+e).text());else if("-"==oper)n=firstNum-Number($("#in"+e).text());else if("x"==oper)n=firstNum*Number($("#in"+e).text());else{if("/"!=oper)return;if(0==Number($("#in"+e).text()))return alert("Toast - Cannot be divided by 0"),void 0;n=firstNum/Number($("#in"+e).text())}$(".btn-op").removeClass("selected"),operNum++,3==operNum&&n==wanted?($("#in"+e).text(n),$("#in"+e).animo({animation:"tada"}),score++,$("#score").text("Score: "+score),process()):($("#in"+e).text(n),$("#in"+lastKey).prop("disabled",!0),lastKey=e,seq="first",oper="")}}}function opKey(e,n){$(".btn-op").removeClass("selected"),$(e).addClass("selected"),seq="second",firstNum=Number($("#in"+lastKey).text()),oper=n}function toMinSec(e){var n=Math.floor(e/60),t=e-60*n,r=n+":"+(10>t?"0"+t:t);return r}function getScore(){return score}function complete(){var e=window.localStorage.getItem("highest");if(score>e&&window.localStorage.setItem("highest",score),getFbLogin()){var n=score;alert(score+" - "+getFbScore()),updateScore(n)}else alert("not login");document.location.href="replay.html?score="+encodeURIComponent(score)}var inputs=new Array,resstr=new String,numofsol=0;resstr="";var wanted=24,ifpower=!1,maxtime=300,countdown=maxtime,myTimer=null,seq="first",firstNum=0,oper="",operNum=0,score=0,lastKey=0,passes=3,fbscore=0,init=function(){initLocalStorage(),onDeviceReady()};$(document).ready(init),window.addEventListener("load",function(){new FastClick(document.body)},!1);