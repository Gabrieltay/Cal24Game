function node(e,n,t,r){this.leftChild=e,this.rightChild=n,this.weight=t,this.opera=r}function BuildUnbalLeftLong(e,n,t,r,u,i,l,o){var a=new node(null,null,n,-1),s=new node(null,null,t,-1),d=new node(a,s,-1e4,i),w=new node(null,null,r,-1),m=new node(d,w,-1e4,l),f=new node(null,null,u,-1);return e=new node(m,f,-1e4,o)}function BuildUnbalRightLong(e,n,t,r,u,i,l,o){var a=new node(null,null,n,-1),s=new node(null,null,t,-1),d=new node(a,s,-1e4,i),w=new node(null,null,r,-1),m=new node(w,d,-1e4,l),f=new node(null,null,u,-1);return e=new node(f,m,-1e4,o)}function BuildBal(e,n,t,r,u,i,l,o){var a=new node(null,null,n,-1),s=new node(null,null,t,-1),d=new node(a,s,-1e4,i),w=new node(null,null,r,-1),m=new node(null,null,u,-1),f=new node(w,m,-1e4,l);return e=new node(d,f,-1e4,o)}function BuildMidLeft(e,n,t,r,u,i,l,o){var a=new node(null,null,n,-1),s=new node(null,null,t,-1),d=new node(a,s,-1e4,i),w=new node(null,null,r,-1),m=new node(w,d,-1e4,l),f=new node(null,null,u,-1);return e=new node(m,f,-1e4,o)}function BuildMidRight(e,n,t,r,u,i,l,o){var a=new node(null,null,n,-1),s=new node(null,null,t,-1),d=new node(a,s,-1e4,i),w=new node(null,null,r,-1),m=new node(d,w,-1e4,l),f=new node(null,null,u,-1);return e=new node(f,m,-1e4,o)}function operate(e,n,t){switch(t){case 0:return result=e+n;case 1:return result=e-n;case 2:return result=e*n;case 3:return result=e/n;case 4:return result=Math.pow(e,n);default:return result=-1e4}}function operation_table(e){switch(e){case 0:return"+";case 1:return"-";case 2:return"*";case 3:return"/";case 4:return"^";default:return"_"}}function regular_prepare(e){switch(e){case 0:return"\\+";case 1:return"\\-";case 2:return"\\*";case 3:return"\\/";case 4:return"\\^";default:return"_"}}function generate_result(e){return null!=e.leftChild&&null!=e.rightChild?"("+generate_result(e.leftChild)+operation_table(e.opera)+generate_result(e.rightChild)+")":e.weight}function generate_RegExp(e){return null!=e.leftChild&&null!=e.rightChild?"\\("+generate_RegExp(e.leftChild)+regular_prepare(e.opera)+generate_RegExp(e.rightChild)+"\\)":e.weight}function weighten(e){null!=e.leftChild&&-1e4==e.leftChild.weight&&weighten(e.leftChild),null!=e.rightChild&&-1e4==e.rightChild.weight&&weighten(e.rightChild),e.weight=operate(e.leftChild.weight,e.rightChild.weight,e.opera)}function myRound(e){return Math.abs(e-Math.round(e))<1e-4?Math.round(e):void 0}function tree_construct(){var e,n,t,r,u,i,l,o=4;for(ifpower&&(o=5),e=0;4>e;e++)for(n=0;4>n;n++)if(e!=n)for(t=0;4>t;t++)if(e!=t&&n!=t)for(r=0;4>r;r++)if(e!=r&&n!=r&&t!=r)for(u=0;o>u;u++)for(i=0;o>i;i++)for(l=0;o>l;l++){var a=new node(null,null,-1e4,-1);a=BuildUnbalLeftLong(a,Number(inputs[e]),Number(inputs[n]),Number(inputs[t]),Number(inputs[r]),u,i,l),weighten(a),myRound(a.weight)==wanted&&add_result(generate_result(a),generate_RegExp(a)),a=BuildUnbalRightLong(a,Number(inputs[e]),Number(inputs[n]),Number(inputs[t]),Number(inputs[r]),u,i,l),weighten(a),myRound(a.weight)==wanted&&add_result(generate_result(a),generate_RegExp(a)),a=BuildBal(a,Number(inputs[e]),Number(inputs[n]),Number(inputs[t]),Number(inputs[r]),u,i,l),weighten(a),myRound(a.weight)==wanted&&add_result(generate_result(a),generate_RegExp(a)),a=BuildMidLeft(a,Number(inputs[e]),Number(inputs[n]),Number(inputs[t]),Number(inputs[r]),u,i,l),weighten(a),myRound(a.weight)==wanted&&add_result(generate_result(a),generate_RegExp(a)),a=BuildMidRight(a,Number(inputs[e]),Number(inputs[n]),Number(inputs[t]),Number(inputs[r]),u,i,l),weighten(a),myRound(a.weight)==wanted&&add_result(generate_result(a),generate_RegExp(a))}}function print_output(){""==resstr&&process()}function add_result(e,n){var t=new RegExp(n+" = "+wanted+"\n");1!=t.test(resstr)&&(resstr=resstr+e+" = "+wanted+"\n",numofsol++)}function process(e){$(e).animo({animation:"tada"}),generate(),reset(),resstr="",numofsol=0,tree_construct(),print_output()}function generate(){inputs[0]=Math.floor(10*Math.random()+1),inputs[1]=Math.floor(10*Math.random()+1),inputs[2]=Math.floor(10*Math.random()+1),inputs[3]=Math.floor(10*Math.random()+1),$("#in1").text(inputs[0]),$("#in2").text(inputs[1]),$("#in3").text(inputs[2]),$("#in4").text(inputs[3])}function timerEvent(){countdown--;var e=Math.floor((maxtime-countdown)/maxtime*100);$("#hourglass").animo("rotate",{degrees:180*(maxtime-countdown)}),$("#label-hour").text(toMinSec(countdown)),$(".progress-bar").css("width",e+"%").attr("aria-valuenow",e),0==countdown&&(alert("Game End"),clearInterval(myTimer))}function start(){score=0,clearInterval(myTimer),$("#score").text(score),countdown=maxtime,myTimer=setInterval(function(){timerEvent()},1e3),process()}function reset(e){$(e).animo({animation:"tada"}),seq="first",firstNum=0,oper="",operNum=0;for(var n=1;4>=n;n++)$("#in"+n).prop("disabled",!1),$("#in"+n).text(inputs[n-1])}function numKey(e){$("#in"+e).animo({animation:"tada"});var n=0;if("first"==seq||""==oper)firstNum=Number($("#in"+e).text()),seq="second",lastKey=e,oper="";else if("second"==seq){if("+"==oper)n=firstNum+Number($("#in"+e).text());else if("-"==oper)n=firstNum-Number($("#in"+e).text());else if("x"==oper)n=firstNum*Number($("#in"+e).text());else{if("/"!=oper)return;n=firstNum/Number($("#in"+e).text())}operNum++,3==operNum&&n==wanted?(score++,$("#score").text(score),process()):($("#in"+e).text(n),seq="first",oper="")}}function opKey(e,n){$(e).animo({animation:"tada"}),$("#in"+lastKey).prop("disabled",!0),oper=n}function toMinSec(e){var n=Math.floor(e/60),t=e-60*n,r=n+":"+t;return r}var inputs=new Array,resstr=new String,numofsol=0;resstr="";var wanted=24,ifpower=!1,maxtime=300,countdown=maxtime,myTimer=null,seq="first",firstNum=0,oper="",operNum=0,score=0,lastKey=0,init=function(){onDeviceReady()};$(document).ready(init),window.addEventListener("load",function(){new FastClick(document.body)},!1);